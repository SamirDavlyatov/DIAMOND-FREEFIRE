<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Админ-панель</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">
<style>
  body {
    margin:0;
    font-family: 'Orbitron', sans-serif;
    background: url('https://i.imgur.com/X0Q0xLJ.jpg') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    text-align: center;
  }
  h1 {
    font-size: 3em;
    color: #ff0;
    margin-top: 20px;
  }
  .container {
    background: rgba(0,0,0,0.6);
    border-radius: 15px;
    padding: 20px;
    width: 90%;
    max-width: 700px;
    margin: 20px auto;
  }
  input, button {
    padding: 10px;
    margin: 5px;
    border-radius: 8px;
    border: none;
    font-size: 1em;
  }
  button {
    cursor: pointer;
    background: #0ff;
    color:#000;
  }
  button:hover {
    background: #00c;
    color: #fff;
  }
  .hidden { display: none; }
  h2 { color: #0ff; }
</style>
</head>
<body>
<h1>Админ-панель</h1>

<div class="container" id="loginContainer">
  <input type="password" id="adminPassword" placeholder="Пароль">
  <button onclick="loginAdmin()">Войти</button>
</div>

<div class="container hidden" id="adminControls">
  <h2>Управление игроками</h2>
  <input type="text" id="targetPlayer" placeholder="Имя игрока">
  <input type="number" id="addLevel" placeholder="Добавить уровень">
  <button onclick="addLevel()">+ Уровень</button>
  <br>
  <button onclick="addDiamonds()">+ Алмазы</button>
  <button onclick="addFFDiamonds()">+ FF Алмазы</button>

  <h2>Онлайн игроки (последние 10 мин)</h2>
  <ul id="onlinePlayers"></ul>
</div>

<script>
let isAdmin = false;

async function loginAdmin() {
  const password = document.getElementById('adminPassword').value;
  const res = await fetch('/admin/login', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ password })
  });
  const data = await res.json();
  if(data.success){
    isAdmin = true;
    document.getElementById('loginContainer').classList.add('hidden');
    document.getElementById('adminControls').classList.remove('hidden');
    loadOnlinePlayers();
  } else {
    alert('Неверный пароль!');
  }
}

async function addLevel() {
  const name = document.getElementById('targetPlayer').value;
  const level = document.getElementById('addLevel').value || 1;
  const res = await fetch('/admin/level', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ name, level })
  });
  const data = await res.json();
  if(data.error) alert(data.error);
  else alert(`${name} теперь уровень ${data.level}`);
}

async function addDiamonds() {
  const name = document.getElementById('targetPlayer').value;
  const res = await fetch('/admin/diamTrill', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ name })
  });
  const data = await res.json();
  if(data.error) alert(data.error);
  else alert(`${name} получил алмазы!`);
}

async function addFFDiamonds() {
  const name = document.getElementById('targetPlayer').value;
  const res = await fetch('/admin/ffTrill', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ name })
  });
  const data = await res.json();
  if(data.error) alert(data.error);
  else alert(`${name} получил FF алмазы!`);
}

async function loadOnlinePlayers() {
  const res = await fetch('/leaderboard');
  const list = await res.json();
  const ul = document.getElementById('onlinePlayers');
  ul.innerHTML = '';
  list.slice(0,10).forEach(p => {
    const li = document.createElement('li');
    li.textContent = `${p.name} - Алмазы: ${p.diamonds} | FF: ${p.ffDiamonds} | Уровень: ${p.level}`;
    ul.appendChild(li);
  });
}

// Автообновление онлайн игроков каждые 10 секунд
setInterval(() => { if(isAdmin) loadOnlinePlayers(); }, 10000);
</script>
</body>
</html>
