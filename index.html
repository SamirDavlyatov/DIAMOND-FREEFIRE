<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>üíé –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –ê–ª–º–∞–∑–Ω–∞—è –ò–º–ø–µ—Ä–∏—è üíé</title>
<style>
body { background: radial-gradient(circle,#0f2027,#203a43,#2c5364); color:#fff; font-family:Arial,sans-serif; text-align:center; margin:0;padding:0; }
h1{margin-top:20px;font-size:3em;color:#FFD700;}
button,input{padding:8px; margin:5px; border-radius:8px; font-size:1em;}
table{margin:10px auto;border-collapse:collapse;color:#fff;}
th,td{border:1px solid #fff;padding:5px;}
</style>
</head>
<body>

<h1>üíé –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –ê–ª–º–∞–∑–Ω–∞—è –ò–º–ø–µ—Ä–∏—è üíé</h1>

<div id="loginScreen">
  <input type="text" id="playerNameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ—ë –∏–º—è">
  <button id="loginBtn">–í–æ–π—Ç–∏</button>
</div>

<div id="gameScreen" style="display:none;">
  <button id="collectBtn">–°–æ–±—Ä–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã üí∞</button>
  <h2>üéØ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
  <table id="leaderboard">
    <tr><th>–ò–≥—Ä–æ–∫</th><th>–ê–ª–º–∞–∑—ã</th><th>FF –ê–ª–º–∞–∑—ã</th><th>–£—Ä–æ–≤–µ–Ω—å</th></tr>
  </table>
  <button onclick="window.location.href='admin.html'">–ê–¥–º–∏–Ω–∫–∞</button>
</div>

<script>
let player = null;

async function updateLeaderboard() {
  const res = await fetch('/leaderboard');
  const data = await res.json();
  const table = document.getElementById('leaderboard');
  table.innerHTML='<tr><th>–ò–≥—Ä–æ–∫</th><th>–ê–ª–º–∞–∑—ã</th><th>FF –ê–ª–º–∞–∑—ã</th><th>–£—Ä–æ–≤–µ–Ω—å</th></tr>';
  data.forEach(p=>{
    const row = table.insertRow();
    row.insertCell(0).innerText=p.name;
    row.insertCell(1).innerText=p.diamonds;
    row.insertCell(2).innerText=p.ffDiamonds;
    row.insertCell(3).innerText=p.level;
  });
}

document.getElementById('loginBtn').addEventListener('click', async ()=>{
  const name = document.getElementById('playerNameInput').value.trim();
  if(!name) return alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è!');
  const res = await fetch('/login',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({name})});
  player = await res.json();
  document.getElementById('loginScreen').style.display='none';
  document.getElementById('gameScreen').style.display='block';
  updateLeaderboard();
});

document.getElementById('collectBtn').addEventListener('click', async ()=>{
  if(!player) return;
  const res = await fetch('/collect',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({name:player.name})});
  const data = await res.json();
  alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${data.gained} –∞–ª–º–∞–∑–æ–≤!`);
  updateLeaderboard();
});
</script>

</body>
</html>
