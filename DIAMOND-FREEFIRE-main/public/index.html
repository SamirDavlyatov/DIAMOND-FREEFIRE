<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>üíé –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –ê–ª–º–∞–∑–Ω–∞—è –ò–º–ø–µ—Ä–∏—è</title>
<style>
body { background: radial-gradient(circle,#0f2027,#203a43,#2c5364); color:#fff; font-family:Arial,sans-serif; text-align:center; margin:0;padding:0;}
button { padding:10px 20px;margin:5px;font-size:1.2em;border-radius:12px;cursor:pointer;}
</style>
</head>
<body>
<h1>üíé –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –ê–ª–º–∞–∑–Ω–∞—è –ò–º–ø–µ—Ä–∏—è</h1>
<input type="text" id="nameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
<button onclick="login()">–í–æ–π—Ç–∏</button>

<div id="game" style="display:none;">
  <h2 id="level">–£—Ä–æ–≤–µ–Ω—å: 1</h2>
  <h2 id="diamonds">–ê–ª–º–∞–∑—ã: 0</h2>
  <h2 id="ffDiamonds">FF –ê–ª–º–∞–∑—ã: 0</h2>
  <button onclick="collect()">–°–æ–±—Ä–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã üí∞</button>
  <h3>–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h3>
  <ul id="leaderboard"></ul>
</div>

<script>
let player = null;

async function login() {
  const name = document.getElementById('nameInput').value.trim();
  if (!name) return alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è!');
  const res = await fetch('/login', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({name})
  });
  player = await res.json();
  document.getElementById('game').style.display='block';
  updateUI();
}

async function collect() {
  const res = await fetch('/collect',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({name: player.name})
  });
  player = await res.json();
  updateUI();
}

async function updateUI() {
  document.getElementById('level').innerText = '–£—Ä–æ–≤–µ–Ω—å: ' + player.level;
  document.getElementById('diamonds').innerText = '–ê–ª–º–∞–∑—ã: ' + player.diamonds;
  document.getElementById('ffDiamonds').innerText = 'FF –ê–ª–º–∞–∑—ã: ' + player.ffDiamonds;

  const lb = await fetch('/leaderboard');
  const leaders = await lb.json();
  const list = document.getElementById('leaderboard');
  list.innerHTML = '';
  leaders.forEach(p => {
    const li = document.createElement('li');
    li.innerText = `${p.name} - ${p.diamonds}üíé / ${p.ffDiamonds}FF`;
    list.appendChild(li);
  });
}
</script>
</body>
</html>
